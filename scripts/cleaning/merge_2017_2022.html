

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>&lt;no title&gt; &#8212; Gender Pay Gap</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'scripts/cleaning/merge_2017_2022';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../docs/introduction.html">
  
  
  
  
  
    <p class="title logo__title">Gender Pay Gap</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../docs/introduction.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/dataset-preprocessing.html">Dataset and preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/story.html">The salary gap in software development</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/scripts/cleaning/merge_2017_2022.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><no title></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="simple visible nav section-nav flex-column">
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2017</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/survey/2017.csv&#39;</span><span class="p">)</span>
<span class="n">df_2018</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/survey/2018.csv&#39;</span><span class="p">)</span>
<span class="n">df_2019</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/survey/2019.csv&#39;</span><span class="p">)</span>
<span class="n">df_2020</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/survey/2020.csv&#39;</span><span class="p">)</span>
<span class="n">df_2021</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/survey/2021.csv&#39;</span><span class="p">)</span>
<span class="n">df_2022</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/survey/2022.csv&#39;</span><span class="p">)</span>
<span class="n">surveys</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_2017</span><span class="p">,</span> <span class="n">df_2018</span><span class="p">,</span> <span class="n">df_2019</span><span class="p">,</span> <span class="n">df_2020</span><span class="p">,</span> <span class="n">df_2021</span><span class="p">,</span> <span class="n">df_2022</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df_2017</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/survey/2017.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">df_2018</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/survey/2018.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">df_2019</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/survey/2019.csv&#39;</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/pandas/io/parsers/readers.py:912,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">899</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">900</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">901</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">908</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">909</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">910</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">912</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/pandas/io/parsers/readers.py:577,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">576</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">577</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">579</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">580</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1407,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1404</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1406</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1407</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1661,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1659</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1660</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1661</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1662</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1663</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1664</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1665</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1666</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1667</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1668</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1669</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1670</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1671</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1672</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/pandas/io/common.py:859,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">854</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">855</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">856</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">857</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">859</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">862</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">863</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">864</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">865</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">866</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">867</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;data/survey/2017.csv&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_2017</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">missing_2017</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2017</span><span class="p">))))</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="mi">2017</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2017</span><span class="p">))))</span>


<span class="k">def</span> <span class="nf">cap_salary</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">or</span> <span class="n">s</span> <span class="o">&gt;</span> <span class="mi">250_000</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">s</span>


<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cap_salary</span><span class="p">)</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;RespondentType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;Professional&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">,</span> <span class="s1">&#39;Professional developer&#39;</span><span class="p">,</span> <span class="s1">&#39;Professional non-developer who sometimes writes code&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Used to be a professional developer&#39;</span><span class="p">,</span> <span class="s1">&#39;None of these&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;stu&#39;</span><span class="p">,</span> <span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;ex-dev&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2017</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;EmploymentStatus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Not employed, and not looking for work&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed part-time&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Independent contractor, freelancer, or self-employed&#39;</span><span class="p">,</span> <span class="s1">&#39;Not employed, but looking for work&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I prefer not to say&#39;</span><span class="p">,</span> <span class="s1">&#39;Retired&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;notwork&#39;</span><span class="p">,</span> <span class="s1">&#39;fulltime&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">,</span> <span class="s1">&#39;independent&#39;</span><span class="p">,</span> <span class="s1">&#39;searching&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;retired&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;CodingActivities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;ProgramHobby&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Yes, both&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes, I program as a hobby&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes, I contribute to open source projects&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Hobby;Contribute to open-source projects&#39;</span><span class="p">,</span> <span class="s1">&#39;Hobby&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;Contribute to open-source projects&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;FormalEducation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Secondary school&#39;</span><span class="p">,</span> <span class="s2">&quot;Some college/university study without earning a bachelor&#39;s degree&quot;</span><span class="p">,</span> <span class="s2">&quot;Bachelor&#39;s degree&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Doctoral degree&#39;</span><span class="p">,</span> <span class="s2">&quot;Master&#39;s degree&quot;</span><span class="p">,</span> <span class="s1">&#39;Professional degree&#39;</span><span class="p">,</span> <span class="s1">&#39;Primary/elementary school&#39;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to answer&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I never completed any formal education&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">,</span> <span class="s1">&#39;tertiary&#39;</span><span class="p">,</span> <span class="s1">&#39;bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;doctor&#39;</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="s1">&#39;professional&#39;</span><span class="p">,</span> <span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;CompanySize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Fewer than 10 employees&#39;</span><span class="p">,</span> <span class="s2">&quot;I don&#39;t know&quot;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to answer&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2 to 9 employees&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">filter_years</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span>
    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;Less than a year&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>


<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;YearsProgram&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_years</span><span class="p">)</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;YearsCodedJob&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_years</span><span class="p">)</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span>
    <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;YearsCodedJobPast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_years</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">replace_multi</span><span class="p">(</span><span class="n">rep</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
    <span class="k">def</span> <span class="nf">_replace_multi</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">for</span> <span class="n">original</span><span class="p">,</span> <span class="n">new</span> <span class="ow">in</span> <span class="n">rep</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;;+&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">_replace_multi</span>


<span class="k">def</span> <span class="nf">copy_replace</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_copy_replace</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span>

    <span class="k">return</span> <span class="n">_copy_replace</span>


<span class="k">def</span> <span class="nf">remove_spaces</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39; ?; ?&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>


<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;DeveloperType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;NonDeveloperType&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span>
    <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;WebDeveloperType&#39;</span><span class="p">],</span> <span class="n">copy_replace</span><span class="p">(</span><span class="s1">&#39;Web developer&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Other&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mobile developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, mobile&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Full stack Web developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, full-stack&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Back-end Web developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, back-end&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Front-end Web developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, front-end&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Web developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, full-stack&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Desktop applications developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, desktop or enterprise applications&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Data scientist&#39;</span><span class="p">:</span> <span class="s1">&#39;Data scientist or machine learning specialist&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Machine learning specialist&#39;</span><span class="p">:</span> <span class="s1">&#39;Data scientist or machine learning specialist&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Developer with a statistics or mathematics background&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Database administrator&#39;</span><span class="p">:</span> <span class="s1">&#39;Data scientist or machine learning specialist&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Graphics programming&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, game or graphics&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Quality assurance engineer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, QA or test&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Graphic designer&#39;</span><span class="p">:</span> <span class="s1">&#39;Designer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C-suite executive&#39;</span><span class="p">:</span> <span class="s1">&#39;Senior Executive (C-Suite, VP, etc.)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Product manager&#39;</span><span class="p">:</span> <span class="s1">&#39;Product manager&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Designer or illustrator&#39;</span><span class="p">:</span> <span class="s1">&#39;Designer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Marketing or sales manager&#39;</span><span class="p">:</span> <span class="s1">&#39;Marketing or sales professional&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Embedded applications/devices developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, embedded applications or devices&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Systems administrator&#39;</span><span class="p">:</span> <span class="s1">&#39;System administrator&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Analyst or consultant&#39;</span><span class="p">:</span> <span class="s1">&#39;Data or business analyst&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Elected official&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
<span class="p">}))</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;JobSatisfaction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;JobSeek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;JobSeekingStatus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I am actively looking for a job&#39;</span><span class="p">,</span> <span class="s1">&#39;I am not interested in new job opportunities&#39;</span><span class="p">,</span>
     <span class="s2">&quot;I&#39;m not actively looking, but I am open to new opportunities&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;maybe&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;Not applicable/ never&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;LearnCodeFrom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;EducationTypes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Online course&#39;</span><span class="p">:</span> <span class="s1">&#39;Online Courses or Certification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Self-taught&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Part-time/evening course&#39;</span><span class="p">:</span> <span class="s1">&#39;School (i.e., University, College, etc)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;On-the-job training&#39;</span><span class="p">:</span> <span class="s1">&#39;On the job training&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Industry certification&#39;</span><span class="p">:</span> <span class="s1">&#39;Online Courses or Certification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Bootcamp&#39;</span><span class="p">:</span> <span class="s1">&#39;Coding Bootcamp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Coding competition&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Open source contributions&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Hackathon&#39;</span><span class="p">:</span> <span class="s1">&#39;Hackathons (virtual or in-person)&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;LangPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;HaveWorkedLanguage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">}))</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;LangFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;WantWorkLanguage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">}))</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;WebframePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;HaveWorkedFramework&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;AngularJS&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Angular&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;WebframeFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;WantWorkFramework&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;AngularJS&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular.js&#39;</span>
<span class="p">}))</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;DatabasePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;HaveWorkedDatabase&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;DatabaseFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;WantWorkDatabase&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;PlatformPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;HaveWorkedPlatform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span>
<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;PlatformFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;WantWorkPlatform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;CodeEditor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;IDE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IPython / Jupyter&#39;</span><span class="p">:</span> <span class="s1">&#39;IPython/Jupyter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PHPStorm&#39;</span><span class="p">:</span> <span class="s1">&#39;PhpStorm&#39;</span>
<span class="p">}))</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;VersionControlSystem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;VersionControl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Subversion&#39;</span><span class="p">:</span> <span class="s1">&#39;SVN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Zip file back-ups&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Team Foundation Server&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s1">&#39;I use some other system&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Visual Source Safe&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Copying and pasting files to network shares&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Rational ClearCase&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s2">&quot;I don&#39;t use version control&quot;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="s1">&#39;Man&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="s1">&#39;Woman&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Gender non-conforming&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Other&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Transgender&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39; &#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Man;Woman&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;University&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes, full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes, part-time&#39;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to say&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">countries</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;United Kingdom of Great Britain and Northern Ireland&#39;</span><span class="p">:</span> <span class="s1">&#39;United Kingdom&#39;</span><span class="p">,</span>
    <span class="s1">&#39;United States of America&#39;</span><span class="p">:</span> <span class="s1">&#39;United States&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Virgin Islands (USA)&#39;</span><span class="p">:</span> <span class="s1">&#39;Virgin Islands&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Viet Nam&#39;</span><span class="p">:</span> <span class="s1">&#39;Vietnam&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Venezuela, Bolivarian Republic of...&#39;</span><span class="p">:</span> <span class="s1">&#39;Venezuela&#39;</span><span class="p">,</span>
    <span class="s1">&#39;North Korea&#39;</span><span class="p">:</span> <span class="s1">&#39;Korea&#39;</span><span class="p">,</span>
    <span class="s1">&#39;South Korea&#39;</span><span class="p">:</span> <span class="s1">&#39;Korea&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Republic of Korea&#39;</span><span class="p">:</span> <span class="s1">&#39;Korea&#39;</span><span class="p">,</span>
    <span class="s2">&quot;Democratic People&#39;s Republic of Korea&quot;</span><span class="p">:</span> <span class="s1">&#39;Korea&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Slovak Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;Slovakia&#39;</span><span class="p">,</span>
    <span class="s1">&#39;New Caledonia (French)&#39;</span><span class="p">:</span> <span class="s1">&#39;New Caledonia&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Martinique (French)&#39;</span><span class="p">:</span> <span class="s1">&#39;Martinique&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Iran, Islamic Republic of...&#39;</span><span class="p">:</span> <span class="s1">&#39;Iran&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Hong Kong (S.A.R.)&#39;</span><span class="p">:</span> <span class="s1">&#39;Hong Kong&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Congo, Republic of the...&#39;</span><span class="p">:</span> <span class="s1">&#39;Congo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Democratic Republic of the Congo&#39;</span><span class="p">:</span> <span class="s1">&#39;Congo&#39;</span><span class="p">,</span>
    <span class="s2">&quot;Lao People&#39;s Democratic Republic&quot;</span><span class="p">:</span> <span class="s1">&#39;Laos&#39;</span><span class="p">,</span>
    <span class="s2">&quot;Côte d&#39;Ivoire&quot;</span><span class="p">:</span> <span class="s1">&#39;Ivory Coast&#39;</span><span class="p">,</span>
    <span class="s2">&quot;Ivory Coast (Cote D&#39;Ivoire)&quot;</span><span class="p">:</span> <span class="s1">&#39;Ivory Coast&#39;</span><span class="p">,</span>
    <span class="s1">&#39;The former Yugoslav Republic of Macedonia&#39;</span><span class="p">:</span> <span class="s1">&#39;Macedonia&#39;</span><span class="p">,</span>
    <span class="s1">&#39;I prefer not to say&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s1">&#39;Other Country (Not Listed Above)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s1">&#39;Azerbaidjan&#39;</span><span class="p">:</span> <span class="s1">&#39;Azerbaijan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Bosnia-Herzegovina&#39;</span><span class="p">:</span> <span class="s1">&#39;Bosnia and Herzegovina&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Libyan Arab Jamahiriya&#39;</span><span class="p">:</span> <span class="s1">&#39;Libya&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Saint Vincent &amp; Grenadines&#39;</span><span class="p">:</span> <span class="s1">&#39;Saint Vincent and the Grenadines&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Syrian Arab Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;Syria&#39;</span><span class="p">,</span>
    <span class="s1">&#39;United Republic of Tanzania&#39;</span><span class="p">:</span> <span class="s1">&#39;Tanzania&#39;</span>
<span class="p">}</span>

<span class="n">clean_2017</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2017</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span>

<span class="n">clean_2017</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Salary</th>
      <th>RespondentType</th>
      <th>Age</th>
      <th>Employment</th>
      <th>CodingActivities</th>
      <th>Education</th>
      <th>OrgSize</th>
      <th>YearsCode</th>
      <th>YearsCodePro</th>
      <th>...</th>
      <th>WebframeFuture</th>
      <th>DatabasePresent</th>
      <th>DatabaseFuture</th>
      <th>PlatformPresent</th>
      <th>PlatformFuture</th>
      <th>CodeEditor</th>
      <th>VersionControlSystem</th>
      <th>Gender</th>
      <th>Student</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>NaN</td>
      <td>stu</td>
      <td>NaN</td>
      <td>notwork</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>secondary</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>iOS</td>
      <td>iOS</td>
      <td>Atom;Xcode</td>
      <td>NaN</td>
      <td>Man</td>
      <td>no</td>
      <td>United States</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>NaN</td>
      <td>stu</td>
      <td>NaN</td>
      <td>parttime</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>tertiary</td>
      <td>20 to 99 employees</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>.NET Core</td>
      <td>MySQL;SQLite</td>
      <td>MySQL;SQLite</td>
      <td>Amazon Web Services (AWS)</td>
      <td>Linux Desktop;Raspberry Pi;Amazon Web Services...</td>
      <td>Atom;Notepad++;Vim;PyCharm;RubyMine;Visual Stu...</td>
      <td>Git</td>
      <td>Man</td>
      <td>yes</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>113750.0</td>
      <td>dev</td>
      <td>NaN</td>
      <td>fulltime</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>bachelor</td>
      <td>10,000 or more employees</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>MySQL</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sublime Text;Vim;IntelliJ</td>
      <td>Mercurial</td>
      <td>Man</td>
      <td>no</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>NaN</td>
      <td>non-dev</td>
      <td>NaN</td>
      <td>fulltime</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>doctor</td>
      <td>10,000 or more employees</td>
      <td>14.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>Hadoop;Node.js;React</td>
      <td>MongoDB;Redis;SQL Server;MySQL;SQLite</td>
      <td>MongoDB;Redis;SQL Server;MySQL;SQLite</td>
      <td>Windows Desktop;Linux Desktop;Mac OS;Amazon We...</td>
      <td>Windows Desktop;Linux Desktop;Mac OS;Amazon We...</td>
      <td>Notepad++;Sublime Text;TextMate;Vim;IPython/Ju...</td>
      <td>Git</td>
      <td>Man</td>
      <td>no</td>
      <td>United States</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>NaN</td>
      <td>dev</td>
      <td>NaN</td>
      <td>fulltime</td>
      <td>Hobby</td>
      <td>master</td>
      <td>10 to 19 employees</td>
      <td>20.0</td>
      <td>10.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no</td>
      <td>Switzerland</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_2018</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">;</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>


<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="mi">2018</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2018</span><span class="p">))))</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;ConvertedSalary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cap_salary</span><span class="p">)</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;CodingActivities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;Hobby&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Hobby&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;OpenSource&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Contribute to open-source projects&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="p">),</span> <span class="n">merge</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes, full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes, part-time&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;25 - 34 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;35 - 44 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;18 - 24 years old&#39;</span><span class="p">,</span>
     <span class="s1">&#39;45 - 54 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;55 - 64 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;Under 18 years old&#39;</span><span class="p">,</span>
     <span class="s1">&#39;65 years or older&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;25-34&#39;</span><span class="p">,</span> <span class="s1">&#39;35-44&#39;</span><span class="p">,</span> <span class="s1">&#39;18-24&#39;</span><span class="p">,</span> <span class="s1">&#39;45-54&#39;</span><span class="p">,</span> <span class="s1">&#39;55-64&#39;</span><span class="p">,</span> <span class="s1">&#39;-17&#39;</span><span class="p">,</span> <span class="s1">&#39;65-&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Not employed, and not looking for work&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed part-time&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Independent contractor, freelancer, or self-employed&#39;</span><span class="p">,</span> <span class="s1">&#39;Not employed, but looking for work&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I prefer not to say&#39;</span><span class="p">,</span> <span class="s1">&#39;Retired&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;notwork&#39;</span><span class="p">,</span> <span class="s1">&#39;fulltime&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">,</span> <span class="s1">&#39;independent&#39;</span><span class="p">,</span> <span class="s1">&#39;searching&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;retired&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;FormalEducation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Secondary school (e.g. American high school, German Realschule or Gymnasium, etc.)&#39;</span><span class="p">,</span>
     <span class="s2">&quot;Some college/university study without earning a degree&quot;</span><span class="p">,</span> <span class="s2">&quot;Bachelor’s degree (BA, BS, B.Eng., etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Other doctoral degree (Ph.D, Ed.D., etc.)&#39;</span><span class="p">,</span> <span class="s2">&quot;Master’s degree (MA, MS, M.Eng., MBA, etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Professional degree (JD, MD, etc.)&#39;</span><span class="p">,</span> <span class="s1">&#39;Primary/elementary school&#39;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to answer&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I never completed any formal education&#39;</span><span class="p">,</span> <span class="s1">&#39;Associate degree&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">,</span> <span class="s1">&#39;tertiary&#39;</span><span class="p">,</span> <span class="s1">&#39;bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;doctor&#39;</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="s1">&#39;professional&#39;</span><span class="p">,</span> <span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;assoc&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;CompanySize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Fewer than 10 employees&#39;</span><span class="p">,</span> <span class="s2">&quot;I don&#39;t know&quot;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to answer&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2 to 9 employees&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Game or graphics developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, game or graphics&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Embedded applications or devices developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, embedded applications or devices&#39;</span><span class="p">,</span>
    <span class="s1">&#39;QA or test developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, QA or test&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Back-end developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, back-end&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Full-stack developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, full-stack&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C-suite executive (CEO, CTO, etc.)&#39;</span><span class="p">:</span> <span class="s1">&#39;Senior Executive (C-Suite, VP, etc.)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Educator or academic researcher&#39;</span><span class="p">:</span> <span class="s1">&#39;Educator or academic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Desktop or enterprise applications developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, desktop or enterprise applications&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Front-end developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, front-end&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mobile developer&#39;</span><span class="p">:</span> <span class="s1">&#39;Developer, mobile&#39;</span><span class="p">,</span>
<span class="p">}))</span>


<span class="k">def</span> <span class="nf">average_year</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">val</span>
    <span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">)]</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>


<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;YearsCoding&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">average_year</span><span class="p">)</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;YearsCodingProf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">average_year</span><span class="p">)</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;JobSatisfaction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Extremely dissatisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Moderately dissatisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Slightly dissatisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Neither satisfied nor dissatisfied&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Slightly satisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Moderately satisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Extremely satisfied&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;JobSeek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;JobSearchStatus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I am actively looking for a job&#39;</span><span class="p">,</span> <span class="s1">&#39;I am not interested in new job opportunities&#39;</span><span class="p">,</span>
     <span class="s2">&quot;I’m not actively looking, but I am open to new opportunities&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;maybe&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s2">&quot;I&#39;ve never had a job&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;CodeEditor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;IDE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IPython / Jupyter&#39;</span><span class="p">:</span> <span class="s1">&#39;IPython/Jupyter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PHPStorm&#39;</span><span class="p">:</span> <span class="s1">&#39;PhpStorm&#39;</span>
<span class="p">}))</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;LangPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;LanguageWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Delphi/Object Pascal&#39;</span><span class="p">:</span> <span class="s1">&#39;Delphi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;HTML&#39;</span><span class="p">:</span> <span class="s1">&#39;HTML/CSS&#39;</span>
<span class="p">}))</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;LangFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;LanguageDesireNextYear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Delphi/Object Pascal&#39;</span><span class="p">:</span> <span class="s1">&#39;Delphi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;HTML&#39;</span><span class="p">:</span> <span class="s1">&#39;HTML/CSS&#39;</span>
<span class="p">}))</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;WebframePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;FrameworkWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Hadoop&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Spark&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TensorFlow&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Torch/PyTorch&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Angular.js&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Angular&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;WebframeFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;FrameworkDesireNextYear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Hadoop&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Spark&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TensorFlow&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Torch/PyTorch&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;DatabasePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;DatabaseWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SQL Server&#39;</span><span class="p">:</span> <span class="s1">&#39;Microsoft SQL Server&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;DatabaseFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;DatabaseDesireNextYear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SQL Server&#39;</span><span class="p">:</span> <span class="s1">&#39;Microsoft SQL Server&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;PlatformPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;PlatformWorkedWith&#39;</span><span class="p">]</span>
<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;PlatformFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;PlatformDesireNextYear&#39;</span><span class="p">]</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="s1">&#39;Man&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="s1">&#39;Woman&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Non-binary, genderqueer, or gender non-conforming&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Transgender&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Woman;Man&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;VersionControlSystem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;VersionControl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Subversion&#39;</span><span class="p">:</span> <span class="s1">&#39;SVN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Zip file back-ups&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Team Foundation Version Control&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s1">&#39;I use some other system&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Copying and pasting files to network shares&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span>
    <span class="s2">&quot;I don&#39;t use version control&quot;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;LearnCodeFrom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;EducationTypes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Other&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Completed an industry certification program (e.g. MCPD)&#39;</span><span class="p">:</span> <span class="s1">&#39;Online Courses or Certification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Contributed to open source software&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Participated in a full-time developer training program or bootcamp&#39;</span><span class="p">:</span> <span class="s1">&#39;Coding Bootcamp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Participated in a hackathon&#39;</span><span class="p">:</span> <span class="s1">&#39;Hackathons (virtual or in-person)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Participated in online coding competitions (e.g. HackerRank, CodeChef, TopCoder)&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Received on-the-job training in software development&#39;</span><span class="p">:</span> <span class="s1">&#39;On the job training&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Taken a part-time in-person course in programming or software development&#39;</span><span class="p">:</span> <span class="s1">&#39;School (i.e., University, College, etc)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Taken an online course in programming or software development (e.g. a MOOC)&#39;</span><span class="p">:</span> <span class="s1">&#39;Online Courses or Certification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Taught yourself a new language, framework, or tool without taking a formal course&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
<span class="p">}))</span>


<span class="k">def</span> <span class="nf">determine_respondent_type</span><span class="p">(</span><span class="n">dev</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">student</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;Developer&#39;</span> <span class="ow">in</span> <span class="n">dev</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;dev&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">student</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">student</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;non-dev&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;stu&#39;</span>


<span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;RespondentType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">clean_2018</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">],</span> <span class="n">determine_respondent_type</span><span class="p">)</span>

<span class="n">clean_2018</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Salary</th>
      <th>CodingActivities</th>
      <th>Country</th>
      <th>Student</th>
      <th>Age</th>
      <th>Employment</th>
      <th>Education</th>
      <th>OrgSize</th>
      <th>DevType</th>
      <th>...</th>
      <th>WebframePresent</th>
      <th>WebframeFuture</th>
      <th>DatabasePresent</th>
      <th>DatabaseFuture</th>
      <th>PlatformPresent</th>
      <th>PlatformFuture</th>
      <th>Gender</th>
      <th>VersionControlSystem</th>
      <th>LearnCodeFrom</th>
      <th>RespondentType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018</td>
      <td>NaN</td>
      <td>Hobby</td>
      <td>Kenya</td>
      <td>no</td>
      <td>25-34</td>
      <td>parttime</td>
      <td>bachelor</td>
      <td>20 to 99 employees</td>
      <td>Developer, full-stack</td>
      <td>...</td>
      <td>Django;React</td>
      <td>Django;React</td>
      <td>Redis;Microsoft SQL Server;MySQL;PostgreSQL;Am...</td>
      <td>Redis;Microsoft SQL Server;MySQL;PostgreSQL;Am...</td>
      <td>AWS;Azure;Linux;Firebase</td>
      <td>AWS;Azure;Linux;Firebase</td>
      <td>Man</td>
      <td>Git</td>
      <td>Other online resources (e.g., videos, blogs, f...</td>
      <td>dev</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018</td>
      <td>70841.0</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>United Kingdom</td>
      <td>no</td>
      <td>35-44</td>
      <td>fulltime</td>
      <td>bachelor</td>
      <td>10,000 or more employees</td>
      <td>Database administrator;DevOps specialist;Devel...</td>
      <td>...</td>
      <td>Django</td>
      <td>React</td>
      <td>Redis;PostgreSQL;Memcached</td>
      <td>PostgreSQL</td>
      <td>Linux</td>
      <td>Linux</td>
      <td>Man</td>
      <td>Git;SVN</td>
      <td>Other online resources (e.g., videos, blogs, f...</td>
      <td>dev</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018</td>
      <td>NaN</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>United States</td>
      <td>no</td>
      <td>NaN</td>
      <td>fulltime</td>
      <td>assoc</td>
      <td>20 to 99 employees</td>
      <td>Engineering manager;Developer, full-stack</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>dev</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>United States</td>
      <td>no</td>
      <td>35-44</td>
      <td>fulltime</td>
      <td>bachelor</td>
      <td>100 to 499 employees</td>
      <td>Developer, full-stack</td>
      <td>...</td>
      <td>NaN</td>
      <td>Angular;.NET Core;React</td>
      <td>Microsoft SQL Server;Microsoft Azure (Tables, ...</td>
      <td>Microsoft SQL Server;Microsoft Azure (Tables, ...</td>
      <td>Azure</td>
      <td>Azure</td>
      <td>Man</td>
      <td>Git</td>
      <td>Online Courses or Certification;Other online r...</td>
      <td>dev</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018</td>
      <td>21426.0</td>
      <td>Hobby</td>
      <td>South Africa</td>
      <td>parttime</td>
      <td>18-24</td>
      <td>fulltime</td>
      <td>tertiary</td>
      <td>10,000 or more employees</td>
      <td>Data or business analyst;Developer, desktop or...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Microsoft SQL Server;PostgreSQL;Oracle;IBM DB2</td>
      <td>PostgreSQL;Oracle;IBM DB2</td>
      <td>Arduino;Windows Desktop or Server</td>
      <td>Arduino;Windows Desktop or Server</td>
      <td>Man</td>
      <td>other</td>
      <td>School (i.e., University, College, etc);On the...</td>
      <td>dev</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_2019</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;RespondentType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;MainBranch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I am a developer by profession&#39;</span><span class="p">,</span> <span class="s1">&#39;I am a student who is learning to code&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I am not primarily a developer, but I write code sometimes as part of my work&#39;</span><span class="p">,</span> <span class="s1">&#39;I code primarily as a hobby&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I used to be a developer by profession, but no longer am&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="s1">&#39;stu&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;ex-dev&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="mi">2019</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2019</span><span class="p">))))</span>
<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;CodingActivities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;Hobbyist&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Hobby&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;OpenSourcer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Once a month or more often&#39;</span><span class="p">,</span> <span class="s1">&#39;Less than once a month but more than once per year&#39;</span><span class="p">,</span> <span class="s1">&#39;Less than once per year&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Never&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Contribute to open-source projects&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="p">),</span> <span class="n">merge</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">age_19</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;-17&#39;</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;18-24&#39;</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;25-34&#39;</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;35-44&#39;</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">55</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;45-54&#39;</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">65</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;55-64&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;65-&#39;</span>


<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">age_19</span><span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Not employed, and not looking for work&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed part-time&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Independent contractor, freelancer, or self-employed&#39;</span><span class="p">,</span> <span class="s1">&#39;Not employed, but looking for work&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Retired&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;notwork&#39;</span><span class="p">,</span> <span class="s1">&#39;fulltime&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">,</span> <span class="s1">&#39;independent&#39;</span><span class="p">,</span> <span class="s1">&#39;searching&#39;</span><span class="p">,</span> <span class="s1">&#39;retired&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes, full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes, part-time&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;EdLevel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Secondary school (e.g. American high school, German Realschule or Gymnasium, etc.)&#39;</span><span class="p">,</span>
     <span class="s2">&quot;Some college/university study without earning a degree&quot;</span><span class="p">,</span> <span class="s2">&quot;Bachelor’s degree (BA, BS, B.Eng., etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Other doctoral degree (Ph.D, Ed.D., etc.)&#39;</span><span class="p">,</span> <span class="s2">&quot;Master’s degree (MA, MS, M.Eng., MBA, etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Professional degree (JD, MD, etc.)&#39;</span><span class="p">,</span> <span class="s1">&#39;Primary/elementary school&#39;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to answer&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I never completed any formal education&#39;</span><span class="p">,</span> <span class="s1">&#39;Associate degree&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">,</span> <span class="s1">&#39;tertiary&#39;</span><span class="p">,</span> <span class="s1">&#39;bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;doctor&#39;</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="s1">&#39;professional&#39;</span><span class="p">,</span> <span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;assoc&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;2-9 employees&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2 to 9 employees&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;C-suite executive (CEO, CTO, etc.)&#39;</span><span class="p">:</span> <span class="s1">&#39;Senior Executive (C-Suite, VP, etc.)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Senior executive/VP&#39;</span><span class="p">:</span> <span class="s1">&#39;Senior Executive (C-Suite, VP, etc.)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Educator&#39;</span><span class="p">:</span> <span class="s1">&#39;Educator or academic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Academic researcher&#39;</span><span class="p">:</span> <span class="s1">&#39;Educator or academic&#39;</span><span class="p">,</span>
<span class="p">}))</span>


<span class="k">def</span> <span class="nf">filter_year_19</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span>
    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;Less than 1 year&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;More than 50 years&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">50</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_year_19</span><span class="p">)</span>
<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_year_19</span><span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Very dissatisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Slightly dissatisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Neither satisfied nor dissatisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Slightly satisfied&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Very satisfied&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;CurrencyDesc&#39;</span><span class="p">]</span>
<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;ConvertedComp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cap_salary</span><span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;CodeEditor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;DevEnviron&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IPython / Jupyter&#39;</span><span class="p">:</span> <span class="s1">&#39;IPython/Jupyter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PHPStorm&#39;</span><span class="p">:</span> <span class="s1">&#39;PhpStorm&#39;</span>
<span class="p">}))</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="s1">&#39;Man&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="s1">&#39;Woman&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Non-binary, genderqueer, or gender non-conforming&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Woman;Man&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;LastHireDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;1-2 years ago&#39;</span><span class="p">,</span> <span class="s1">&#39;3-4 years ago&#39;</span><span class="p">,</span> <span class="s2">&quot;I&#39;ve never had a job&quot;</span><span class="p">,</span> <span class="s1">&#39;NA - I am an independent contractor or self employed&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Between 1 and 2 years ago&#39;</span><span class="p">,</span> <span class="s1">&#39;Between 2 and 4 years ago&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">add_school_19</span><span class="p">(</span><span class="n">main</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">edu</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;School (i.e., University, College, etc)&#39;</span> <span class="k">if</span> <span class="n">edu</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;tertiary&#39;</span><span class="p">,</span> <span class="s1">&#39;bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;doctor&#39;</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;professional&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">main</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">main</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">val</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">main</span><span class="si">}</span><span class="s1">;</span><span class="si">{</span><span class="n">add</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span> <span class="k">if</span> <span class="n">val</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>


<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;LearnCodeFrom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;EduOther&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Completed an industry certification program (e.g. MCPD)&#39;</span><span class="p">:</span> <span class="s1">&#39;Online Courses or Certification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Contributed to open source software&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Participated in a full-time developer training program or bootcamp&#39;</span><span class="p">:</span> <span class="s1">&#39;Coding Bootcamp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Participated in a hackathon&#39;</span><span class="p">:</span> <span class="s1">&#39;Hackathons (virtual or in-person)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Participated in online coding competitions (e.g. HackerRank, CodeChef, TopCoder)&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Received on-the-job training in software development&#39;</span><span class="p">:</span> <span class="s1">&#39;On the job training&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Taken a part-time in-person course in programming or software development&#39;</span><span class="p">:</span> <span class="s1">&#39;School (i.e., University, College, etc)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Taken an online course in programming or software development (e.g. a MOOC)&#39;</span><span class="p">:</span> <span class="s1">&#39;Online Courses or Certification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Taught yourself a new language, framework, or tool without taking a formal course&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
<span class="p">}))</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">],</span> <span class="n">add_school_19</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;JobSeek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;JobSeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I am actively looking for a job&#39;</span><span class="p">,</span> <span class="s1">&#39;I am not interested in new job opportunities&#39;</span><span class="p">,</span>
     <span class="s2">&quot;I’m not actively looking, but I am open to new opportunities&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;maybe&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># VCS missing for 2019</span>
<span class="n">missing_2019</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2019</span><span class="p">))))</span>
<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;VersionControlSystem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2019</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;LangPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;LanguageWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">,</span> <span class="s1">&#39;Other(s):&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}))</span>
<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;LangFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;LanguageDesireNextYear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">,</span> <span class="s1">&#39;Other(s):&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}))</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;WebframePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;WebFrameWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Angular.js&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Angular&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>

<span class="p">}))</span>
<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;WebframeFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;WebFrameDesireNextYear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Angular.js&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Angular&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;DatabasePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;DatabaseWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SQL Server&#39;</span><span class="p">:</span> <span class="s1">&#39;Microsoft SQL Server&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;DatabaseFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;DatabaseDesireNextYear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SQL Server&#39;</span><span class="p">:</span> <span class="s1">&#39;Microsoft SQL Server&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;PlatformPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;PlatformWorkedWith&#39;</span><span class="p">]</span>
<span class="n">clean_2019</span><span class="p">[</span><span class="s1">&#39;PlatformFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2019</span><span class="p">[</span><span class="s1">&#39;PlatformDesireNextYear&#39;</span><span class="p">]</span>

<span class="n">clean_2019</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RespondentType</th>
      <th>Year</th>
      <th>CodingActivities</th>
      <th>Age</th>
      <th>Employment</th>
      <th>Country</th>
      <th>Student</th>
      <th>Education</th>
      <th>OrgSize</th>
      <th>DevType</th>
      <th>...</th>
      <th>JobSeek</th>
      <th>VersionControlSystem</th>
      <th>LangPresent</th>
      <th>LangFuture</th>
      <th>WebframePresent</th>
      <th>WebframeFuture</th>
      <th>DatabasePresent</th>
      <th>DatabaseFuture</th>
      <th>PlatformPresent</th>
      <th>PlatformFuture</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>stu</td>
      <td>2019</td>
      <td>Hobby</td>
      <td>-17</td>
      <td>notwork</td>
      <td>United Kingdom</td>
      <td>no</td>
      <td>primary</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>HTML/CSS;Java;JavaScript;Python</td>
      <td>C;C++;C#;Go;HTML/CSS;Java;JavaScript;Python;SQL</td>
      <td>Django;Flask</td>
      <td>Flask;jQuery</td>
      <td>SQLite</td>
      <td>MySQL</td>
      <td>MacOS;Windows</td>
      <td>Android;Arduino;Windows</td>
    </tr>
    <tr>
      <th>1</th>
      <td>stu</td>
      <td>2019</td>
      <td>NaN</td>
      <td>18-24</td>
      <td>searching</td>
      <td>Bosnia and Herzegovina</td>
      <td>yes</td>
      <td>secondary</td>
      <td>NaN</td>
      <td>Developer, desktop or enterprise applications;...</td>
      <td>...</td>
      <td>yes</td>
      <td>NaN</td>
      <td>C++;HTML/CSS;Python</td>
      <td>C++;HTML/CSS;JavaScript;SQL</td>
      <td>Django</td>
      <td>Django</td>
      <td>NaN</td>
      <td>MySQL</td>
      <td>Windows</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>2</th>
      <td>non-dev</td>
      <td>2019</td>
      <td>Hobby</td>
      <td>25-34</td>
      <td>fulltime</td>
      <td>Thailand</td>
      <td>no</td>
      <td>bachelor</td>
      <td>100 to 499 employees</td>
      <td>Designer;Developer, back-end;Developer, front-...</td>
      <td>...</td>
      <td>maybe</td>
      <td>NaN</td>
      <td>HTML/CSS</td>
      <td>Elixir;HTML/CSS</td>
      <td>NaN</td>
      <td>Other(s):</td>
      <td>PostgreSQL</td>
      <td>PostgreSQL</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>dev</td>
      <td>2019</td>
      <td>NaN</td>
      <td>18-24</td>
      <td>fulltime</td>
      <td>United States</td>
      <td>no</td>
      <td>bachelor</td>
      <td>100 to 499 employees</td>
      <td>Developer, full-stack</td>
      <td>...</td>
      <td>no</td>
      <td>NaN</td>
      <td>C;C++;C#;Python;SQL</td>
      <td>C;C#;JavaScript;SQL</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>MySQL;SQLite</td>
      <td>MySQL;SQLite</td>
      <td>Linux;Windows</td>
      <td>Linux;Windows</td>
    </tr>
    <tr>
      <th>4</th>
      <td>dev</td>
      <td>2019</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>25-34</td>
      <td>fulltime</td>
      <td>Ukraine</td>
      <td>no</td>
      <td>bachelor</td>
      <td>10,000 or more employees</td>
      <td>Educator or academic;Developer, desktop or ent...</td>
      <td>...</td>
      <td>no</td>
      <td>NaN</td>
      <td>C++;HTML/CSS;Java;JavaScript;Python;SQL;VBA</td>
      <td>HTML/CSS;Java;JavaScript;SQL;WebAssembly</td>
      <td>Django;Express;Flask;jQuery;React.js;Spring</td>
      <td>Flask;jQuery;React.js;Spring</td>
      <td>Couchbase;MongoDB;MySQL;Oracle;PostgreSQL;SQLite</td>
      <td>Couchbase;Firebase;MongoDB;MySQL;Oracle;Postgr...</td>
      <td>Android;Linux;MacOS;Slack;Windows</td>
      <td>Android;Docker;Kubernetes;Linux;Slack</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_2020</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">missing_2020</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2020</span><span class="p">))))</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="mi">2020</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2020</span><span class="p">))))</span>
<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;RespondentType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;MainBranch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I am a developer by profession&#39;</span><span class="p">,</span> <span class="s1">&#39;I am a student who is learning to code&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I am not primarily a developer, but I write code sometimes as part of my work&#39;</span><span class="p">,</span> <span class="s1">&#39;I code primarily as a hobby&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I used to be a developer by profession, but no longer am&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="s1">&#39;stu&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;ex-dev&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;CodingActivities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;Hobbyist&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Hobby&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Not employed, and not looking for work&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed part-time&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Independent contractor, freelancer, or self-employed&#39;</span><span class="p">,</span> <span class="s1">&#39;Not employed, but looking for work&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Retired&#39;</span><span class="p">,</span> <span class="s1">&#39;Student&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;notwork&#39;</span><span class="p">,</span> <span class="s1">&#39;fulltime&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">,</span> <span class="s1">&#39;independent&#39;</span><span class="p">,</span> <span class="s1">&#39;searching&#39;</span><span class="p">,</span> <span class="s1">&#39;retired&#39;</span><span class="p">,</span> <span class="s1">&#39;notwork&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">age_19</span><span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2020</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;EdLevel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Secondary school (e.g. American high school, German Realschule or Gymnasium, etc.)&#39;</span><span class="p">,</span>
     <span class="s2">&quot;Some college/university study without earning a degree&quot;</span><span class="p">,</span> <span class="s2">&quot;Bachelor’s degree (B.A., B.S., B.Eng., etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Other doctoral degree (Ph.D., Ed.D., etc.)&#39;</span><span class="p">,</span> <span class="s2">&quot;Master’s degree (M.A., M.S., M.Eng., MBA, etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Professional degree (JD, MD, etc.)&#39;</span><span class="p">,</span> <span class="s1">&#39;Primary/elementary school&#39;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to answer&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I never completed any formal education&#39;</span><span class="p">,</span> <span class="s1">&#39;Associate degree (A.A., A.S., etc.)&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">,</span> <span class="s1">&#39;tertiary&#39;</span><span class="p">,</span> <span class="s1">&#39;bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;doctor&#39;</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="s1">&#39;professional&#39;</span><span class="p">,</span> <span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;assoc&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;2-9 employees&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2 to 9 employees&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Senior executive/VP&#39;</span><span class="p">:</span> <span class="s1">&#39;Senior Executive (C-Suite, VP, etc.)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Educator&#39;</span><span class="p">:</span> <span class="s1">&#39;Educator or academic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Academic researcher&#39;</span><span class="p">:</span> <span class="s1">&#39;Educator or academic&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_year_19</span><span class="p">)</span>
<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_year_19</span><span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Very dissatisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Slightly dissatisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Neither satisfied nor dissatisfied&#39;</span><span class="p">,</span> <span class="s1">&#39;Slightly satisfied&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Very satisfied&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;CurrencyDesc&#39;</span><span class="p">]</span>
<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;ConvertedComp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cap_salary</span><span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;CodeEditor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2020</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="s1">&#39;Man&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="s1">&#39;Woman&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Non-binary, genderqueer, or gender non-conforming&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Woman;Man&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2020</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;LearnCodeFrom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2020</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;JobSeek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;JobSeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I am actively looking for a job&#39;</span><span class="p">,</span> <span class="s1">&#39;I am not interested in new job opportunities&#39;</span><span class="p">,</span>
     <span class="s2">&quot;I’m not actively looking, but I am open to new opportunities&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;maybe&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;VersionControlSystem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2020</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;LangPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;LanguageWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">}))</span>
<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;LangFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;LanguageDesireNextYear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">}))</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;WebframePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;WebframeWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Angular.js&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Angular&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;WebframeFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;WebframeDesireNextYear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Angular.js&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Angular&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular/Angular.js&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;DatabasePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;DatabaseWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;DatabaseFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;DatabaseDesireNextYear&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;PlatformPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;PlatformWorkedWith&#39;</span><span class="p">]</span>
<span class="n">clean_2020</span><span class="p">[</span><span class="s1">&#39;PlatformFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2020</span><span class="p">[</span><span class="s1">&#39;PlatformDesireNextYear&#39;</span><span class="p">]</span>

<span class="n">clean_2020</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>RespondentType</th>
      <th>CodingActivities</th>
      <th>Employment</th>
      <th>Age</th>
      <th>Country</th>
      <th>Student</th>
      <th>Education</th>
      <th>OrgSize</th>
      <th>DevType</th>
      <th>...</th>
      <th>JobSeek</th>
      <th>VersionControlSystem</th>
      <th>LangPresent</th>
      <th>LangFuture</th>
      <th>WebframePresent</th>
      <th>WebframeFuture</th>
      <th>DatabasePresent</th>
      <th>DatabaseFuture</th>
      <th>PlatformPresent</th>
      <th>PlatformFuture</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020</td>
      <td>dev</td>
      <td>Hobby</td>
      <td>independent</td>
      <td>NaN</td>
      <td>Germany</td>
      <td>NaN</td>
      <td>master</td>
      <td>2 to 9 employees</td>
      <td>Developer, desktop or enterprise applications;...</td>
      <td>...</td>
      <td>no</td>
      <td>NaN</td>
      <td>C#;HTML/CSS;JavaScript</td>
      <td>C#;HTML/CSS;JavaScript</td>
      <td>ASP.NET;ASP.NET Core</td>
      <td>ASP.NET Core</td>
      <td>Elasticsearch;Microsoft SQL Server;Oracle</td>
      <td>Microsoft SQL Server</td>
      <td>Windows</td>
      <td>Android;iOS;Kubernetes;Microsoft Azure;Windows</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>dev</td>
      <td></td>
      <td>fulltime</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>NaN</td>
      <td>bachelor</td>
      <td>1,000 to 4,999 employees</td>
      <td>Developer, full-stack;Developer, mobile</td>
      <td>...</td>
      <td>no</td>
      <td>NaN</td>
      <td>JavaScript;Swift</td>
      <td>Python;Swift</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>iOS</td>
      <td>iOS;Kubernetes;Linux;MacOS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>non-dev</td>
      <td>Hobby</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Russian Federation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Objective-C;Python;Swift</td>
      <td>Objective-C;Python;Swift</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020</td>
      <td>dev</td>
      <td>Hobby</td>
      <td>NaN</td>
      <td>25-34</td>
      <td>Albania</td>
      <td>NaN</td>
      <td>master</td>
      <td>20 to 99 employees</td>
      <td>NaN</td>
      <td>...</td>
      <td>maybe</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>ex-dev</td>
      <td>Hobby</td>
      <td>fulltime</td>
      <td>25-34</td>
      <td>United States</td>
      <td>NaN</td>
      <td>bachelor</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>HTML/CSS;Ruby;SQL</td>
      <td>Java;Ruby;Scala</td>
      <td>Ruby on Rails</td>
      <td>Django;Ruby on Rails</td>
      <td>MySQL;PostgreSQL;Redis;SQLite</td>
      <td>MySQL;PostgreSQL</td>
      <td>AWS;Docker;Linux;MacOS;Windows</td>
      <td>Docker;Google Cloud Platform;Heroku;Linux;Windows</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_2021</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">missing_2021</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2021</span><span class="p">))))</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="mi">2021</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2021</span><span class="p">))))</span>
<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;RespondentType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;MainBranch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I am a developer by profession&#39;</span><span class="p">,</span> <span class="s1">&#39;I am a student who is learning to code&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I am not primarily a developer, but I write code sometimes as part of my work&#39;</span><span class="p">,</span> <span class="s1">&#39;I code primarily as a hobby&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I used to be a developer by profession, but no longer am&#39;</span><span class="p">,</span> <span class="s1">&#39;None of these&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="s1">&#39;stu&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;ex-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;CodingActivities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2021</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Not employed, and not looking for work&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed part-time&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Independent contractor, freelancer, or self-employed&#39;</span><span class="p">,</span> <span class="s1">&#39;Not employed, but looking for work&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Retired&#39;</span><span class="p">,</span> <span class="s1">&#39;Student, full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Student, part-time&#39;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to say&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;notwork&#39;</span><span class="p">,</span> <span class="s1">&#39;fulltime&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">,</span> <span class="s1">&#39;independent&#39;</span><span class="p">,</span> <span class="s1">&#39;searching&#39;</span><span class="p">,</span> <span class="s1">&#39;retired&#39;</span><span class="p">,</span> <span class="s1">&#39;notwork&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">is_student_21</span><span class="p">(</span><span class="n">emp</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">emp</span> <span class="o">==</span> <span class="s1">&#39;Student, part-time&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;parttime&#39;</span>
    <span class="k">if</span> <span class="n">emp</span> <span class="o">==</span> <span class="s1">&#39;Student, full-time&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;yes&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;no&#39;</span>


<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_student_21</span><span class="p">)</span>
<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Prefer not to say&#39;</span><span class="p">,</span> <span class="s1">&#39;25-34 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;18-24 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;35-44 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;45-54 years old&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Under 18 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;65 years or older&#39;</span><span class="p">,</span> <span class="s1">&#39;55-64 years old&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;25-34&#39;</span><span class="p">,</span> <span class="s1">&#39;18-24&#39;</span><span class="p">,</span> <span class="s1">&#39;35-44&#39;</span><span class="p">,</span> <span class="s1">&#39;45-54&#39;</span><span class="p">,</span> <span class="s1">&#39;-17&#39;</span><span class="p">,</span> <span class="s1">&#39;65-&#39;</span><span class="p">,</span> <span class="s1">&#39;55-64&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;EdLevel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Secondary school (e.g. American high school, German Realschule or Gymnasium, etc.)&#39;</span><span class="p">,</span>
     <span class="s2">&quot;Some college/university study without earning a degree&quot;</span><span class="p">,</span> <span class="s2">&quot;Bachelor’s degree (B.A., B.S., B.Eng., etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Other doctoral degree (Ph.D., Ed.D., etc.)&#39;</span><span class="p">,</span> <span class="s2">&quot;Master’s degree (M.A., M.S., M.Eng., MBA, etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Professional degree (JD, MD, etc.)&#39;</span><span class="p">,</span> <span class="s1">&#39;Primary/elementary school&#39;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to answer&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I never completed any formal education&#39;</span><span class="p">,</span> <span class="s1">&#39;Associate degree (A.A., A.S., etc.)&#39;</span><span class="p">,</span> <span class="s1">&#39;Something else&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">,</span> <span class="s1">&#39;tertiary&#39;</span><span class="p">,</span> <span class="s1">&#39;bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;doctor&#39;</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="s1">&#39;professional&#39;</span><span class="p">,</span> <span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;assoc&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I don’t know&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Other (please specify):&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Senior executive/VP&#39;</span><span class="p">:</span> <span class="s1">&#39;Senior Executive (C-Suite, VP, etc.)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Educator&#39;</span><span class="p">:</span> <span class="s1">&#39;Educator or academic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Academic researcher&#39;</span><span class="p">:</span> <span class="s1">&#39;Educator or academic&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_year_19</span><span class="p">)</span>
<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_year_19</span><span class="p">)</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2021</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span>
<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;ConvertedCompYearly&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cap_salary</span><span class="p">)</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;CodeEditor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;NEWCollabToolsHaveWorkedWith&#39;</span><span class="p">]</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="s1">&#39;Man&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="s1">&#39;Woman&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Non-binary, genderqueer, or gender non-conforming&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Or, in your own words:&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Prefer not to say&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Man;Woman&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2021</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;LearnCodeFrom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;LearnCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;School&#39;</span><span class="p">:</span> <span class="s1">&#39;School (i.e., University, College, etc)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Other online resources (ex: videos, blogs, etc)&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Online Forum&#39;</span><span class="p">:</span> <span class="s1">&#39;Other online resources (e.g., videos, blogs, forum)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Other (please specify):&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
<span class="p">}))</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;JobSeek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2021</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;VersionControlSystem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2021</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;LangPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;LanguageHaveWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">}))</span>
<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;LangFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;LanguageWantToWorkWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">}))</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;WebframePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;WebframeHaveWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;WebframeFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;WebframeWantToWorkWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;DatabasePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;DatabaseHaveWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;DatabaseFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;DatabaseWantToWorkWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;PlatformPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;PlatformHaveWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span>
<span class="n">clean_2021</span><span class="p">[</span><span class="s1">&#39;PlatformFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2021</span><span class="p">[</span><span class="s1">&#39;PlatformWantToWorkWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span>

<span class="n">clean_2021</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>RespondentType</th>
      <th>CodingActivities</th>
      <th>Employment</th>
      <th>Country</th>
      <th>Student</th>
      <th>Age</th>
      <th>Education</th>
      <th>OrgSize</th>
      <th>DevType</th>
      <th>...</th>
      <th>JobSeek</th>
      <th>VersionControlSystem</th>
      <th>LangPresent</th>
      <th>LangFuture</th>
      <th>WebframePresent</th>
      <th>WebframeFuture</th>
      <th>DatabasePresent</th>
      <th>DatabaseFuture</th>
      <th>PlatformPresent</th>
      <th>PlatformFuture</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021</td>
      <td>dev</td>
      <td>NaN</td>
      <td>independent</td>
      <td>Slovakia</td>
      <td>no</td>
      <td>25-34</td>
      <td>secondary</td>
      <td>20 to 99 employees</td>
      <td>Developer, mobile</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C++;HTML/CSS;JavaScript;Objective-C;PHP;Swift</td>
      <td>Swift</td>
      <td>Laravel;Symfony</td>
      <td>NaN</td>
      <td>PostgreSQL;SQLite</td>
      <td>SQLite</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021</td>
      <td>stu</td>
      <td>NaN</td>
      <td>notwork</td>
      <td>Netherlands</td>
      <td>yes</td>
      <td>18-24</td>
      <td>bachelor</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>JavaScript;Python</td>
      <td>NaN</td>
      <td>Angular;Flask;Vue.js</td>
      <td>NaN</td>
      <td>PostgreSQL</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021</td>
      <td>non-dev</td>
      <td>NaN</td>
      <td>notwork</td>
      <td>Russian Federation</td>
      <td>yes</td>
      <td>18-24</td>
      <td>bachelor</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Assembly;C;Python;R;Rust</td>
      <td>Julia;Python;Rust</td>
      <td>Flask</td>
      <td>Flask</td>
      <td>SQLite</td>
      <td>SQLite</td>
      <td>Heroku</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021</td>
      <td>dev</td>
      <td>NaN</td>
      <td>fulltime</td>
      <td>Austria</td>
      <td>no</td>
      <td>35-44</td>
      <td>master</td>
      <td>100 to 499 employees</td>
      <td>Developer, front-end</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>JavaScript;TypeScript</td>
      <td>JavaScript;TypeScript</td>
      <td>Angular;jQuery</td>
      <td>Angular;jQuery</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021</td>
      <td>dev</td>
      <td>NaN</td>
      <td>independent</td>
      <td>United Kingdom</td>
      <td>no</td>
      <td>25-34</td>
      <td>master</td>
      <td>Just me - I am a freelancer, sole proprietor, ...</td>
      <td>Developer, desktop or enterprise applications;...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Bash/Shell;HTML/CSS;Python;SQL</td>
      <td>Bash/Shell;HTML/CSS;Python;SQL</td>
      <td>Flask</td>
      <td>Flask</td>
      <td>Elasticsearch;PostgreSQL;Redis</td>
      <td>Cassandra;Elasticsearch;PostgreSQL;Redis</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_2022</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">missing_2022</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2022</span><span class="p">))))</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">((</span><span class="mi">2022</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_2022</span><span class="p">))))</span>
<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;RespondentType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;MainBranch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I am a developer by profession&#39;</span><span class="p">,</span> <span class="s1">&#39;I am learning to code&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I am not primarily a developer, but I write code sometimes as part of my work&#39;</span><span class="p">,</span> <span class="s1">&#39;I code primarily as a hobby&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I used to be a developer by profession, but no longer am&#39;</span><span class="p">,</span> <span class="s1">&#39;None of these&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="s1">&#39;stu&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;ex-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;non-dev&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;CodingActivities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;CodingActivities&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">remove_spaces</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Other (please specify):&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
<span class="p">}))</span>


<span class="k">def</span> <span class="nf">get_first</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>


<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_first</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Not employed, and not looking for work&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed, full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Employed, part-time&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Independent contractor, freelancer, or self-employed&#39;</span><span class="p">,</span> <span class="s1">&#39;Not employed, but looking for work&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Retired&#39;</span><span class="p">,</span> <span class="s1">&#39;Student, full-time&#39;</span><span class="p">,</span> <span class="s1">&#39;Student, part-time&#39;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to say&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;notwork&#39;</span><span class="p">,</span> <span class="s1">&#39;fulltime&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">,</span> <span class="s1">&#39;independent&#39;</span><span class="p">,</span> <span class="s1">&#39;searching&#39;</span><span class="p">,</span> <span class="s1">&#39;retired&#39;</span><span class="p">,</span> <span class="s1">&#39;notwork&#39;</span><span class="p">,</span> <span class="s1">&#39;parttime&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Prefer not to say&#39;</span><span class="p">,</span> <span class="s1">&#39;25-34 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;18-24 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;35-44 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;45-54 years old&#39;</span><span class="p">,</span>
     <span class="s1">&#39;Under 18 years old&#39;</span><span class="p">,</span> <span class="s1">&#39;65 years or older&#39;</span><span class="p">,</span> <span class="s1">&#39;55-64 years old&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;25-34&#39;</span><span class="p">,</span> <span class="s1">&#39;18-24&#39;</span><span class="p">,</span> <span class="s1">&#39;35-44&#39;</span><span class="p">,</span> <span class="s1">&#39;45-54&#39;</span><span class="p">,</span> <span class="s1">&#39;-17&#39;</span><span class="p">,</span> <span class="s1">&#39;65-&#39;</span><span class="p">,</span> <span class="s1">&#39;55-64&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_student_21</span><span class="p">)</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;EdLevel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Secondary school (e.g. American high school, German Realschule or Gymnasium, etc.)&#39;</span><span class="p">,</span>
     <span class="s2">&quot;Some college/university study without earning a degree&quot;</span><span class="p">,</span> <span class="s2">&quot;Bachelor’s degree (B.A., B.S., B.Eng., etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Other doctoral degree (Ph.D., Ed.D., etc.)&#39;</span><span class="p">,</span> <span class="s2">&quot;Master’s degree (M.A., M.S., M.Eng., MBA, etc.)&quot;</span><span class="p">,</span>
     <span class="s1">&#39;Professional degree (JD, MD, etc.)&#39;</span><span class="p">,</span> <span class="s1">&#39;Primary/elementary school&#39;</span><span class="p">,</span> <span class="s1">&#39;I prefer not to answer&#39;</span><span class="p">,</span>
     <span class="s1">&#39;I never completed any formal education&#39;</span><span class="p">,</span> <span class="s1">&#39;Associate degree (A.A., A.S., etc.)&#39;</span><span class="p">,</span> <span class="s1">&#39;Something else&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">,</span> <span class="s1">&#39;tertiary&#39;</span><span class="p">,</span> <span class="s1">&#39;bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;doctor&#39;</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="s1">&#39;professional&#39;</span><span class="p">,</span> <span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;assoc&#39;</span><span class="p">,</span>
     <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;I don’t know&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;DevType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Other (please specify):&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Educator&#39;</span><span class="p">:</span> <span class="s1">&#39;Educator or academic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Academic researcher&#39;</span><span class="p">:</span> <span class="s1">&#39;Educator or academic&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_year_19</span><span class="p">)</span>
<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_year_19</span><span class="p">)</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2022</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;Currency&#39;</span><span class="p">]</span>
<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;ConvertedCompYearly&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cap_salary</span><span class="p">)</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;CodeEditor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;NEWCollabToolsHaveWorkedWith&#39;</span><span class="p">]</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="s1">&#39;Man&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="s1">&#39;Woman&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Non-binary, genderqueer, or gender non-conforming&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Or, in your own words:&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Prefer not to say&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Man;Woman&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Man;;Woman&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2022</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;LearnCodeFrom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;LearnCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;Other (please specify):&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
<span class="p">}))</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;JobSeek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2022</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;VersionControlSystem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_2022</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;LangPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;LanguageHaveWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">}))</span>
<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;LangFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;LanguageWantToWorkWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span><span class="s1">&#39;Matlab&#39;</span><span class="p">:</span> <span class="s1">&#39;MATLAB&#39;</span><span class="p">}))</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;WebframePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;WebframeHaveWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;WebframeFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;WebframeWantToWorkWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;DatabasePresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;DatabaseHaveWorkedWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
<span class="p">}))</span>
<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;DatabaseFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;DatabaseWantToWorkWith&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_multi</span><span class="p">({</span>
    <span class="s1">&#39;IBM Db2&#39;</span><span class="p">:</span> <span class="s1">&#39;IBM DB2&#39;</span><span class="p">,</span>
<span class="p">}))</span>

<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;PlatformPresent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;PlatformHaveWorkedWith&#39;</span><span class="p">]</span>
<span class="n">clean_2022</span><span class="p">[</span><span class="s1">&#39;PlatformFuture&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_2022</span><span class="p">[</span><span class="s1">&#39;PlatformWantToWorkWith&#39;</span><span class="p">]</span>

<span class="n">clean_2022</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>RespondentType</th>
      <th>CodingActivities</th>
      <th>Employment</th>
      <th>Age</th>
      <th>Country</th>
      <th>Student</th>
      <th>Education</th>
      <th>OrgSize</th>
      <th>DevType</th>
      <th>...</th>
      <th>JobSeek</th>
      <th>VersionControlSystem</th>
      <th>LangPresent</th>
      <th>LangFuture</th>
      <th>WebframePresent</th>
      <th>WebframeFuture</th>
      <th>DatabasePresent</th>
      <th>DatabaseFuture</th>
      <th>PlatformPresent</th>
      <th>PlatformFuture</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022</td>
      <td>non-dev</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022</td>
      <td>dev</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>fulltime</td>
      <td>NaN</td>
      <td>Canada</td>
      <td>no</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>JavaScript;TypeScript</td>
      <td>Rust;TypeScript</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022</td>
      <td>non-dev</td>
      <td>Hobby</td>
      <td>fulltime</td>
      <td>25-34</td>
      <td>United Kingdom</td>
      <td>no</td>
      <td>master</td>
      <td>20 to 99 employees</td>
      <td>Data scientist or machine learning specialist;...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C#;C++;HTML/CSS;JavaScript;Python</td>
      <td>C#;C++;HTML/CSS;JavaScript;TypeScript</td>
      <td>Angular.js</td>
      <td>Angular;Angular.js</td>
      <td>Microsoft SQL Server</td>
      <td>Microsoft SQL Server</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022</td>
      <td>dev</td>
      <td>I don’t code outside of work</td>
      <td>fulltime</td>
      <td>35-44</td>
      <td>Israel</td>
      <td>no</td>
      <td>bachelor</td>
      <td>100 to 499 employees</td>
      <td>Developer, full-stack</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C#;JavaScript;SQL;TypeScript</td>
      <td>C#;SQL;TypeScript</td>
      <td>ASP.NET;ASP.NET Core</td>
      <td>ASP.NET;ASP.NET Core</td>
      <td>Microsoft SQL Server</td>
      <td>Microsoft SQL Server</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022</td>
      <td>dev</td>
      <td>Hobby</td>
      <td>fulltime</td>
      <td>25-34</td>
      <td>United States</td>
      <td>no</td>
      <td>bachelor</td>
      <td>20 to 99 employees</td>
      <td>Developer, front-end;Developer, full-stack;Dev...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C#;HTML/CSS;JavaScript;SQL;Swift;TypeScript</td>
      <td>C#;Elixir;F#;Go;JavaScript;Rust;TypeScript</td>
      <td>Angular;ASP.NET;ASP.NET Core ;jQuery;Node.js</td>
      <td>Angular;ASP.NET Core ;Blazor;Node.js</td>
      <td>Cloud Firestore;Elasticsearch;Microsoft SQL Se...</td>
      <td>Cloud Firestore;Elasticsearch;Firebase Realtim...</td>
      <td>Firebase;Microsoft Azure</td>
      <td>Firebase;Microsoft Azure</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">clean_2017</span><span class="p">,</span> <span class="n">clean_2018</span><span class="p">,</span> <span class="n">clean_2019</span><span class="p">,</span> <span class="n">clean_2020</span><span class="p">,</span> <span class="n">clean_2021</span><span class="p">,</span> <span class="n">clean_2022</span><span class="p">])</span>
<span class="n">final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">final</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint16&#39;</span><span class="p">)</span>
<span class="n">final</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">final</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="s1">&#39;JobSat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int8&#39;</span><span class="p">)</span>
<span class="n">final</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="s1">&#39;YearsCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int8&#39;</span><span class="p">)</span>
<span class="n">final</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="s1">&#39;YearsCodePro&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int8&#39;</span><span class="p">)</span>
<span class="n">final</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">CategoricalDtype</span><span class="p">([</span><span class="s1">&#39;-17&#39;</span><span class="p">,</span> <span class="s1">&#39;18-24&#39;</span><span class="p">,</span> <span class="s1">&#39;25-34&#39;</span><span class="p">,</span> <span class="s1">&#39;35-44&#39;</span><span class="p">,</span> <span class="s1">&#39;45-54&#39;</span><span class="p">,</span> <span class="s1">&#39;55-64&#39;</span><span class="p">,</span> <span class="s1">&#39;65-&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">final</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">CategoricalDtype</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="s1">&#39;secondary&#39;</span><span class="p">,</span> <span class="s1">&#39;tertiary&#39;</span><span class="p">,</span> <span class="s1">&#39;assoc&#39;</span><span class="p">,</span> <span class="s1">&#39;bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="s1">&#39;professional&#39;</span><span class="p">,</span> <span class="s1">&#39;doctor&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">final</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="s1">&#39;OrgSize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">CategoricalDtype</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Just me - I am a freelancer, sole proprietor, etc.&#39;</span><span class="p">,</span> <span class="s1">&#39;2 to 9 employees&#39;</span><span class="p">,</span>
     <span class="s1">&#39;10 to 19 employees&#39;</span><span class="p">,</span> <span class="s1">&#39;20 to 99 employees&#39;</span><span class="p">,</span> <span class="s1">&#39;100 to 499 employees&#39;</span><span class="p">,</span>
     <span class="s1">&#39;500 to 999 employees&#39;</span><span class="p">,</span> <span class="s1">&#39;1,000 to 4,999 employees&#39;</span><span class="p">,</span> <span class="s1">&#39;5,000 to 9,999 employees&#39;</span><span class="p">,</span>
     <span class="s1">&#39;10,000 or more employees&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">final</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="s1">&#39;LastNewJob&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">CategoricalDtype</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Less than a year ago&#39;</span><span class="p">,</span> <span class="s1">&#39;Between 1 and 2 years ago&#39;</span><span class="p">,</span> <span class="s1">&#39;Between 2 and 4 years ago&#39;</span><span class="p">,</span> <span class="s1">&#39;More than 4 years ago&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">))</span>

<span class="k">for</span> <span class="n">cat_col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Employment&#39;</span><span class="p">,</span> <span class="s1">&#39;RespondentType&#39;</span><span class="p">,</span> <span class="s1">&#39;JobSeek&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Student&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">]:</span>
    <span class="n">final</span><span class="p">[</span><span class="n">cat_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="n">cat_col</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">str_col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CodingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;DevType&#39;</span><span class="p">,</span>
                <span class="s1">&#39;LearnCodeFrom&#39;</span><span class="p">,</span> <span class="s1">&#39;LangPresent&#39;</span><span class="p">,</span> <span class="s1">&#39;LangFuture&#39;</span><span class="p">]:</span>
    <span class="n">final</span><span class="p">[</span><span class="n">str_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="n">str_col</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>

<span class="c1"># Dropped columns (irrelevant):</span>

<span class="c1"># &#39;Currency&#39;, &#39;WebframePresent&#39;, &#39;WebframeFuture&#39;, &#39;DatabasePresent&#39;, &#39;DatabaseFuture&#39;, &#39;PlatformPresent&#39;,</span>
<span class="c1"># &#39;PlatformFuture&#39;, &#39;CodeEditor&#39;, &#39;VersionControlSystem&#39;</span>

<span class="n">final</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Salary</th>
      <th>JobSat</th>
      <th>YearsCode</th>
      <th>YearsCodePro</th>
      <th>Age</th>
      <th>Education</th>
      <th>OrgSize</th>
      <th>LastNewJob</th>
      <th>Employment</th>
      <th>RespondentType</th>
      <th>JobSeek</th>
      <th>Gender</th>
      <th>Student</th>
      <th>Country</th>
      <th>CodingActivities</th>
      <th>DevType</th>
      <th>LearnCodeFrom</th>
      <th>LangPresent</th>
      <th>LangFuture</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>secondary</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>notwork</td>
      <td>stu</td>
      <td>maybe</td>
      <td>Man</td>
      <td>no</td>
      <td>United States</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>&lt;NA&gt;</td>
      <td>Online Courses or Certification;Other online r...</td>
      <td>Swift</td>
      <td>Swift</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>9</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>tertiary</td>
      <td>20 to 99 employees</td>
      <td>NaN</td>
      <td>parttime</td>
      <td>stu</td>
      <td>NaN</td>
      <td>Man</td>
      <td>yes</td>
      <td>United Kingdom</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>&lt;NA&gt;</td>
      <td>Online Courses or Certification;Hackathons (vi...</td>
      <td>JavaScript;Python;Ruby;SQL</td>
      <td>Java;Python;Ruby;SQL</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>113750.0</td>
      <td>5</td>
      <td>20</td>
      <td>20</td>
      <td>NaN</td>
      <td>bachelor</td>
      <td>10,000 or more employees</td>
      <td>NaN</td>
      <td>fulltime</td>
      <td>dev</td>
      <td>NaN</td>
      <td>Man</td>
      <td>no</td>
      <td>United Kingdom</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>&lt;NA&gt;</td>
      <td>Other online resources (e.g., videos, blogs, f...</td>
      <td>Java;PHP;Python</td>
      <td>C;Python;Rust</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>NaN</td>
      <td>2</td>
      <td>14</td>
      <td>9</td>
      <td>NaN</td>
      <td>doctor</td>
      <td>10,000 or more employees</td>
      <td>Between 2 and 4 years ago</td>
      <td>fulltime</td>
      <td>non-dev</td>
      <td>yes</td>
      <td>Man</td>
      <td>no</td>
      <td>United States</td>
      <td>Hobby;Contribute to open-source projects</td>
      <td>Data scientist or machine learning specialist</td>
      <td>&lt;NA&gt;</td>
      <td>MATLAB;Python;R;SQL</td>
      <td>MATLAB;Python;R;SQL</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>NaN</td>
      <td>4</td>
      <td>20</td>
      <td>10</td>
      <td>NaN</td>
      <td>master</td>
      <td>10 to 19 employees</td>
      <td>NaN</td>
      <td>fulltime</td>
      <td>dev</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no</td>
      <td>Switzerland</td>
      <td>Hobby</td>
      <td>Developer, mobile;Developer, game or graphics;...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save to disk:</span>

<span class="c1"># final.to_parquet(&#39;SO_2_0.pq.gz&#39;, compression=&#39;gzip&#39;)</span>
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./scripts/cleaning"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="simple visible nav section-nav flex-column">
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By InfoVis Group J3
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>